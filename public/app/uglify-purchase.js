function nextTick(e){setTimeout(e,0)}function make4Len16(e){var t=e.toString(16);while(t.length<4){t="0"+t}return t}function encode_utf8(e){return unescape(encodeURIComponent(e))}function decode_utf8(e){return decodeURIComponent(escape(e))}function ab2str(e){if(e.constructor.name=="ArrayBuffer"){e=new Uint8Array(e)}return decode_utf8(String.fromCharCode.apply(null,e))}function str2ab(e,t,r){e=encode_utf8(e);var n=e.length;if(r)n++;if(!t){t=new ArrayBuffer(n)}var o=new Uint8Array(t);if(r)o[e.length]=0;for(var a=0,i=e.length;a<i;a++){o[a]=e.charCodeAt(a)}return t}var slashN="\n".charCodeAt(0);function writeLine(e,t,r){if(t.constructor.name=="Object")t=JSON.stringify(t);writeString(e,t+"\n",r)}function readLine(e,t){var r=[];function n(){e.read(function(o){for(var a=0;a<o.byteLength;a++){if(o[a]==slashN){var i=o.subarray(0,a);r.push(i);var s="";for(var c in r){c=r[c];s+=ab2str(c)}var u=o.subarray(a+1);e.unshift(u);t(s);return}}r.push(o);n()})}n()}function readString(e,t){var r="";e.onClose=function(){t(r)};function n(t){r+=ab2str(t);e.read(n)}e.read(n)}function writeString(e,t,r){if(t.constructor.name=="Object")t=JSON.stringify(t);e.write(str2ab(t),r)}function appendBuffer(e,t){var r=new Uint8Array(e.byteLength+t.byteLength);r.set(e,0);r.set(t,e.byteLength);return r}var timeThing=(new Date).getTime();function timeTrace(e){var t=(new Date).getTime();console.log(e+": "+(t-timeThing));timeThing=t}function bufferToHex(e){var t=new Uint8Array(e);var r="";for(var n in t){n=t[n];if(n<16)r+="0"+n.toString(16);else r+=n.toString(16)}return r}function hexToBuffer(e){var t=new ArrayBuffer(e.length/2);var r=new Uint8Array(t);for(var n=0;n<e.length/2;n++){var o=e.substr(n*2,2);r[n]=parseInt(o,16)}return t}function base64ToArrayBuffer(e){var t=window.atob(e);var r=t.length;var n=new Uint8Array(r);for(var o=0;o<r;o++){var a=t.charCodeAt(o);n[o]=a}return n.buffer}function arrayBufferToBase64(e){var t="";var r=new Uint8Array(e);var n=r.byteLength;for(var o=0;o<n;o++){t+=String.fromCharCode(r[o])}return window.btoa(t)}var b64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var b64pad="=";function hex2b64(e){var t;var r;var n="";for(t=0;t+3<=e.length;t+=3){r=parseInt(e.substring(t,t+3),16);n+=b64map.charAt(r>>6)+b64map.charAt(r&63)}if(t+1==e.length){r=parseInt(e.substring(t,t+1),16);n+=b64map.charAt(r<<2)}else if(t+2==e.length){r=parseInt(e.substring(t,t+2),16);n+=b64map.charAt(r>>2)+b64map.charAt((r&3)<<4)}while((n.length&3)>0){n+=b64pad}return n}if(!String.prototype.startsWith){Object.defineProperty(String.prototype,"startsWith",{enumerable:false,configurable:false,writable:false,value:function(e,t){t=t||0;return this.lastIndexOf(e,t)===t}})}function getQueryVariable(e,t){if(!t)t=window.location;var r=t.search.substring(1);var n=r.split("&");for(var o=0;o<n.length;o++){var a=n[o].split("=");if(decodeURIComponent(a[0])==e){return decodeURIComponent(a[1])}}}Object.fromArray=function(e){var t={};for(var r in e){var n=e[r];t[n]=n}return t};$.ajaxTransport("+binary",function(e,t,r){if(window.FormData&&(e.dataType&&e.dataType=="binary"||e.data&&(window.ArrayBuffer&&e.data instanceof ArrayBuffer||window.Blob&&e.data instanceof Blob))){return{send:function(t,r){var n=new XMLHttpRequest,o=e.url,a=e.type,i=e.async||true,s=e.responseType||"blob",c=e.data||null,u=e.username||null,l=e.password||null;n.addEventListener("load",function(){var t={};t[e.dataType]=n.response;r(n.status,n.statusText,t,n.getAllResponseHeaders())});n.open(a,o,i,u,l);for(var d in t){n.setRequestHeader(d,t[d])}n.responseType=s;n.send(c)},abort:function(){r.abort()}}}});function throttleTimeout(e,t,r,n){if(e){clearTimeout(e.timeout)}else{e={items:[]}}e.timeout=setTimeout(function(){n(e.items);e.items=[]},r);e.items.push(t);return e}function copyTextToClipboard(e){var t=document.createElement("textarea");t.style.position="fixed";t.style.top=0;t.style.left=0;t.style.width="2em";t.style.height="2em";t.style.padding=0;t.style.border="none";t.style.outline="none";t.style.boxShadow="none";t.style.background="transparent";t.value=e;document.body.appendChild(t);t.select();try{var r=document.execCommand("copy")}catch(n){console.log("Oops, unable to copy")}document.body.removeChild(t)}function showNotification(e,t){console.log("notification:",e);if(!window.chrome||!window.chrome.notifications)return;var r=chrome.runtime.getManifest();var n=r.name;t=t||r.icons[128];chrome.notifications.create({type:"basic",iconUrl:t,title:n,message:e})}var blobFromUrl=function(){var e={};return function(t,r){if(e[t]){r(e[t]);return}var n=new XMLHttpRequest;n.open("GET",t,true);n.responseType="blob";n.onload=function(n){r(e[t]=window.URL.createObjectURL(this.response))};n.send()}}();function Success(){}(function(){function*e(){}var t=e();t.constructor.prototype.async=function(){var e=this;var t=e.next();if(t.done)return;function r(){t=e.throw(new Error(arguments));o()}function n(){var r=arguments[0];t=e.next(r);o()}function o(o){var a;var i;if(t.done)return;if(!t.value){t=e.next(n);return}if(t.value.constructor==Promise){t.value.then(n).catch(r);return}if(t.value==Error){a=true;t=e.next(r)}else if(t.value==Success){i=true;t=e.next(n)}else{throw new Error("Unexpected yield value for callback. Only Error and Success allowed.")}if(!t.value)throw new Error("Double yield callbacks must explicitly define both Error and Success");if(t.value==Error&&a)throw new Error("Error callback already defined");else if(t.value==Success&&i)throw new Error("Success callback already defined");else if(t.value!=Error&&t.value!=Success)throw new Error("Unexpected yield value for callback. Only Error and Success allowed.");if(a)t=e.next(n);else t=e.next(r)}o()}})();function spewSocket(e){e.read(function(t){console.log(ab2str(t));spewSocket(e)})}function getAuthToken(e,t){chrome.identity.getAuthToken({interactive:e,scopes:["https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/chromewebstore.readonly"]},function(e){if(!e)console.error("unable to get authToken",chrome.runtime.lastError);t(e)})}(function(){var e=console.log;var t=console.error;var r="";console.log=function(){e.apply(console,arguments);try{var t=Array.prototype.slice.call(arguments);for(var n in t){if(t[n]&&t[n].constructor!=String)t[n]=JSON.stringify(t[n])}r+=t.join(" ")+"\n"}catch(o){}};window.getConsoleLog=function(){return r};function n(e){return e.getConsoleLog&&e.getConsoleLog()||"getConsoleLog not found"}window.gistConsoleLog=function(e){chrome.runtime.getBackgroundPage(function(t){var r={};r["background.txt"]={content:n(t)};var o=chrome.app.window.getAll();for(var a in o){a=o[a];r["window-"+a.id+".txt"]={content:n(a.contentWindow)}}var i={description:chrome.runtime.getManifest().name+" console log","public":false,files:r};fetch("https://api.github.com/gists",{method:"POST",body:JSON.stringify(i)}).then(function(t){t.json().then(function(t){e(t.html_url)})})})}})();$(document).ready(function(){$("#purchase-options").hide();chrome.storage.local.get(["vysorUsage"],function(e){var t=e.vysorUsage;if(!t)t=0;var r=t/(60*60*1e3);r=Math.round(r*2)/2;$("#used").html("<span class='time-highlight'>You've used Vysor for "+r+" hours. Support Vysor. Go Pro.</span>")});function e(e){$.each(e.response.details.inAppProducts,function(e,t){var r=t.sku;var n=t.localeData[0].title;var o=t.prices[0];var a=o.valueMicros/1e6+" "+o.currencyCode;var i=$('<tr><td id="sub"></td><td id="price"></td><td><a id="purchase" class="green-icon fa fa-shopping-cart"> Google Wallet</a></td></tr>');i.find("#sub").text(n);i.find("#price").text(a);i.find("#purchase").click(function(){google.payments.inapp.buy({parameters:{env:"prod"},sku:r,success:function(){refreshLicenseManager();console.log("success",arguments)},failure:function(){refreshLicenseManager();console.log("failure",arguments)}})});$("#prices").append(i)});var n=$('<tr><td id="sub"></td><td id="price"></td><td></td></tr>');$("#prices").append(n);t();r();$("#purchase-options-loading h4").hide();$("#purchase-options").show()}function t(){var e=$('<tr><td id="sub"></td><td id="price"></td><td><a id="purchase" class="green-icon fa fa-shopping-cart"> PayPal</a></td></tr>');e.find("#sub").text("Lifetime Pass");e.find("#price").text("39.99 USD");e.find("#purchase").click(function(){getAuthToken(true,function(e){if(!e){showNotification("Unable to retrieve Google auth token. Are you behind a firewall or using a VPN?");return}var t="https://clockworkbilling.appspot.com/api/v1/paypalorder/koushd@gmail.com/vysor.lifetime?return_url=https://vysor.clockworkmod.com/purchase&sandbox=false&token="+e;chrome.browser.openTab({url:t});chrome.app.window.current().close()}.bind(this))});$("#prices").append(e)}function r(){var e=$('<tr><td id="sub"></td><td id="price"></td><td><a id="purchase" class="green-icon fa fa-shopping-cart"> Credit Card or Alipay</a></td></tr>');e.find("#sub").text("Enterprise Licensing (Monthly)");e.find("#price").text("$2");e.find("#purchase").click(function(){var e="https://billing.vysor.io/";chrome.browser.openTab({url:e});chrome.app.window.current().close()});$("#prices").append(e)}function n(){var e=$('<tr><td id="sub"></td><td id="price"></td><td><p id="purchase" class="green-icon fa fa-shopping-cart"> Google Wallet unavailable!</p></td></tr>');e.find("#sub").text("Monthly Subscription");e.find("#price").text("1.99 USD");$("#prices").append(e);var e=$('<tr><td id="sub"></td><td id="price"></td><td><p id="purchase" class="green-icon fa fa-shopping-cart"> Google Wallet unavailable!</p></td></tr>');e.find("#sub").text("Annual Subscription");e.find("#price").text("9.99 USD");$("#prices").append(e);var e=$('<tr><td id="sub"></td><td id="price"></td><td><p id="purchase" class="green-icon fa fa-shopping-cart"> Google Wallet unavailable!</p></td></tr>');e.find("#sub").text("Lifetime Pass");e.find("#price").text("39.99 USD");$("#prices").append(e);var e=$('<tr><td id="sub"></td><td id="price"></td><td></td></tr>');$("#prices").append(e);console.log(arguments);$("#purchase-options-loading h4").html('Chrome Web Store subscription pricing unavailable.<br/>This may be caused when behind a VPN or firewall.<br/>Please make ensure you are <a href="https://www.google.com/chrome/browser/signin.html" target="_blank">logged into Chrome</a><br/>and <a href="https://developer.chrome.com/webstore/pricing#seller" target="_blank">your country supports Chrome Web Store payments</a>.<br/>Alternatively, you may purchase the Lifetime Pass through PayPal.');$("#purchase-options").show();t();r()}google.payments.inapp.getSkuDetails({parameters:{env:"prod"},success:e,failure:n});$("#retrieve").click(function(){getAuthToken(true,function(e){if(!e){console.log("Unable to get token for retrieve?");return}refreshLicenseManager()})})});
